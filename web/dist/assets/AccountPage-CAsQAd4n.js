import{r as e,j as a}from"./vendor-react-CfCdiEH_.js";import{a as t}from"./core-VSXNFQTj.js";import"./vendor-ByYHSpNA.js";function s({token:s}){const[n,i]=e.useState({username:"",email:"",first_name:"",last_name:""}),[r,l]=e.useState(!1),[d,m]=e.useState(""),[u,o]=e.useState(!1);e.useEffect((()=>{(async()=>{try{const e=await t("/me",{token:s}),a=(null==e?void 0:e.user)||{};i({username:String(a.username||""),email:String(a.email||""),first_name:String(a.first_name||""),last_name:String(a.last_name||"")})}catch{}})()}),[s]);return a.jsxs("section",{children:[a.jsx("h2",{children:"Account"}),a.jsxs("form",{onSubmit:async e=>{var a;e.preventDefault(),l(!0),m(""),o(!1);try{await t("/me",{method:"PATCH",token:s,body:n}),o(!0)}catch(i){const e=null==(a=null==i?void 0:i.data)?void 0:a.error;m({invalid_email:"Please enter a valid email address.",invalid_username:"Username must be 2-64 chars (letters, numbers, _ . -).",username_taken:"That username is already taken.",no_changes:"Make a change before saving."}[e]||"Save failed")}finally{l(!1)}},children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"pf-username",children:"Username"}),a.jsx("input",{id:"pf-username","data-testid":"pf-username",value:n.username,onChange:e=>i((a=>({...a,username:e.target.value})))})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"pf-email",children:"Email"}),a.jsx("input",{id:"pf-email","data-testid":"pf-email",value:n.email,onChange:e=>i((a=>({...a,email:e.target.value})))})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"pf-first",children:"First name"}),a.jsx("input",{id:"pf-first","data-testid":"pf-first",value:n.first_name,onChange:e=>i((a=>({...a,first_name:e.target.value})))})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"pf-last",children:"Last name"}),a.jsx("input",{id:"pf-last","data-testid":"pf-last",value:n.last_name,onChange:e=>i((a=>({...a,last_name:e.target.value})))})]}),a.jsx("button",{type:"submit","data-testid":"pf-save",disabled:r,children:"Save"})]}),u&&a.jsx("div",{"data-testid":"pf-ok",children:"Saved"}),d&&a.jsx("div",{role:"alert",children:d})]})}export{s as default};
