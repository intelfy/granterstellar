const o="/api";function t(o,t=[]){try{0;const n=new URL(o);return n.origin===window.location.origin?(window.open(n.toString(),"_blank","noopener,noreferrer"),!0):"https:"===n.protocol&&(!(!Array.isArray(t)||0===t.length)&&(!!t.includes(n.origin)&&(window.open(n.toString(),"_blank","noopener,noreferrer"),!0)))}catch{return!1}}function n(o){try{const t=new URL(o,window.location.origin),n=t.origin===window.location.origin,r="http:"===t.protocol&&("localhost"===t.hostname||"127.0.0.1"===t.hostname);if(n||r)return window.location.assign(t.toString()),!0}catch{}return!1}async function r(t,{method:n="GET",token:r,body:e,orgId:a}={}){const i=await fetch(`${o}${t}`,{method:n,headers:{"Content-Type":"application/json",...r?{Authorization:`Bearer ${r}`}:{},...a?{"X-Org-ID":a}:{}},body:e?JSON.stringify(e):void 0});let s=null;try{s=await i.json()}catch{}if(!i.ok){const o=new Error(`${i.status}`);throw o.status=i.status,o.data=s,o}return s}async function e(o,{method:t="POST",token:n,body:e,orgId:a}={}){const i=await r(o,{method:t,token:n,body:e,orgId:a});if(i&&"object"==typeof i&&i.job_id){const o=i.job_id;for(let t=0;t<20;t++){await new Promise((o=>setTimeout(o,300)));const t=await r(`/ai/jobs/${o}`,{token:n,orgId:a});if("done"===t.status)return t.result;if("error"===t.status)throw new Error(t.error||"AI job failed")}throw new Error("AI job still processing; try again later")}return i}async function a(t,{token:n,orgId:r,file:e}){const a=new FormData;a.append("file",e);const i=await fetch(`${o}${t}`,{method:"POST",headers:{...n?{Authorization:`Bearer ${n}`}:{},...r?{"X-Org-ID":r}:{}},body:a});let s=null;try{s=await i.json()}catch{}if(!i.ok){const o=new Error(`${i.status}`);throw o.status=i.status,o.data=s,o}return s}export{r as a,e as b,a as c,n as o,t as s};
